# Generated by Ansible for {{ ansible_nodename  }}
################################################################################
# zplug
################################################################################
source ~/.zplug/init.zsh
zplug "zsh-users/zsh-autosuggestions"
zplug "zsh-users/zsh-history-substring-search"
zplug "willghatch/zsh-cdr"
zplug "zsh-users/zsh-completions"

zplug "plugins/git",   	    from:oh-my-zsh
zplug "plugins/autojump",   from:oh-my-zsh
zplug "modules/prompt",     from:prezto
zplug 'dracula/zsh', as:theme

zplug "zsh-users/zsh-syntax-highlighting", defer:2
zplug "zsh-users/zaw", defer:2

zplug check || zplug install
zplug load

################################################################################
# 基本設定
################################################################################
bindkey -e
setopt prompt_subst
setopt menu_complete

zstyle ':completion:*' menu select interactive
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"

################################################################################
# カラー
################################################################################
case ${SOLARIZED_THEME:-dark} in
    light) bkg=white;;
    *)     bkg=black;;
esac

case `whoami` in
     root) ucolor=red;;
     *)    ucolor=green;;   
esac

ZSH_HIGHLIGHT_HIGHLIGHTERS=(main brackets)
ZSH_HIGHLIGHT_STYLES[alias]='none'
ZSH_HIGHLIGHT_STYLES[builtin]='none'
ZSH_HIGHLIGHT_STYLES[function]='none'
ZSH_HIGHLIGHT_STYLES[command]='none'
ZSH_HIGHLIGHT_STYLES[precommand]='none'
ZSH_HIGHLIGHT_STYLES[commandseparator]='none'
ZSH_HIGHLIGHT_STYLES[hashed-command]='none'
ZSH_HIGHLIGHT_STYLES[unknown-token]='fg=198'
ZSH_HIGHLIGHT_STYLES[single-quoted-argument]='fg=215'
ZSH_HIGHLIGHT_STYLES[double-quoted-argument]='fg=215'

################################################################################
# プロンプト
################################################################################
{% raw %}
ZSH_THEME_GIT_PROMPT_PREFIX=" [%{%B%F{blue}%}"
ZSH_THEME_GIT_PROMPT_SUFFIX="%{%f%k%b%K{${bkg}}%B%F{green}%}]"
ZSH_THEME_GIT_PROMPT_DIRTY=" %{%F{red}%}*%{%f%k%b%}"
ZSH_THEME_GIT_PROMPT_CLEAN=""

PROMPT='%{%f%k%b%}
%{%K{${bkg}}%B%F{${ucolor}}%}%n%{%B%F{blue}%}@%{%B%F{cyan}%}%m%{%B%F{green}%} %{%b%F{yellow}%K{${bkg}}%}%~%{%B%F{green}%}$(git_prompt_info)%E%{%f%k%b%}
%{%K{${bkg}}%}%{%K{${bkg}}%} %B%# %{%f%k%b%}%b'
RPROMPT=''
{% endraw %}

################################################################################
# Keychain 等
################################################################################
if [[ ($TERM == xterm*) || (-z $SSH_CLIENT && -z $EMACS) ]]; then
    if [[ -z $TMUX_PANE ]]; then
        # keychain
        if (which =keychain >& /dev/null) then
            keychain ~/.ssh/*.id_rsa
            if [[ -e ~/.keychain/`hostname`-sh ]]; then
                    source ~/.keychain/`hostname`-sh >& /dev/null
            fi
        fi
        # emacs
	local EMACS_VERSION=${${${(f)"$(emacs --version)"}[1]}##GNU Emacs }
        if [[ $EMACS_VERSION > 22.9 ]] then
            =emacs --daemon >& /dev/null
        fi
        # tmux
        tmux a || tmux || echo 'Unable to start tmux.'
    elif (which =keychain >& /dev/null) then
        keychain ~/.ssh/*.id_rsa
        if [[ -e ~/.keychain/`hostname`-sh ]]; then
	    source ~/.keychain/`hostname`-sh >& /dev/null
        fi
        # clear
    fi
fi

# Local Variables:
# mode: sh
# End:
###############################################################################
