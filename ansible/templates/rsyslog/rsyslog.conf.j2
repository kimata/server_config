# Generated by Ansible for {{ ansible_hostname  }}.{{ network.domain }}

# MODULES
module(load="imuxsock") 	# provides support for local system logging
module(load="imklog")   	# provides kernel logging support
module(load="imudp") 		# provides UDP syslog reception
module(load="imtcp")		# provides TCP syslog reception

# REMOTE INPUT
input(type="imudp" port="514")
input(type="imtcp" port="514")

# GENERAL
$KLogPermitNonKernelFacility	on
$ActionFileDefaultTemplate	RSYSLOG_TraditionalFileFormat
$RepeatedMsgReduction 		on

$FileOwner 			syslog
$FileGroup 			adm
$FileCreateMode 		0640
$DirCreateMode 			0755
$Umask 				0022
$PrivDropToUser 		syslog
$PrivDropToGroup 		syslog

$WorkDirectory 			/var/spool/rsyslog

# FILTER
:msg, contains, "[dhclient]"	~

# INCLUDES
$IncludeConfig 			/etc/rsyslog.d/*.conf
